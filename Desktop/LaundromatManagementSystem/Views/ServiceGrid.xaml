<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:LaundromatManagementSystem.ViewModels"
             x:Class="LaundromatManagementSystem.Views.ServiceGrid"
             x:DataType="vm:ServiceGridViewModel">

    <Grid RowDefinitions="Auto, *">

        <!-- Category Tabs -->
        <Grid Grid.Row="0"
              ColumnDefinitions="*, *, *, *"
              ColumnSpacing="12"
              Margin="0,0,0,24">

            <!-- WASH Button -->
            <Border Grid.Column="0"
                    BackgroundColor="{Binding WashButtonBackground}"
                    Stroke="{Binding WashButtonBorder}"
                    StrokeThickness="2"
                    StrokeShape="RoundRectangle 8,8,8,8"
                    HeightRequest="64">
                <Label Text="{Binding WashText}"
                       FontSize="14"
                       FontAttributes="Bold"
                       TextColor="{Binding WashButtonTextColor}"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding SelectWashCommand}"/>
                </Border.GestureRecognizers>
            </Border>

            <!-- DRY Button -->
            <Border Grid.Column="1"
                    BackgroundColor="{Binding DryButtonBackground}"
                    Stroke="{Binding DryButtonBorder}"
                    StrokeThickness="2"
                    StrokeShape="RoundRectangle 8,8,8,8"
                    HeightRequest="64">
                <Label Text="{Binding DryText}"
                       FontSize="14"
                       FontAttributes="Bold"
                       TextColor="{Binding DryButtonTextColor}"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding SelectDryCommand}"/>
                </Border.GestureRecognizers>
            </Border>

            <!-- ADD-ON Button -->
            <Border Grid.Column="2"
                    BackgroundColor="{Binding AddonButtonBackground}"
                    Stroke="{Binding AddonButtonBorder}"
                    StrokeThickness="2"
                    StrokeShape="RoundRectangle 8,8,8,8"
                    HeightRequest="64">
                <Label Text="{Binding AddonText}"
                       FontSize="14"
                       FontAttributes="Bold"
                       TextColor="{Binding AddonButtonTextColor}"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding SelectAddonCommand}"/>
                </Border.GestureRecognizers>
            </Border>

            <!-- PACKAGE Button -->
            <Border Grid.Column="3"
                    BackgroundColor="{Binding PackageButtonBackground}"
                    Stroke="{Binding PackageButtonBorder}"
                    StrokeThickness="2"
                    StrokeShape="RoundRectangle 8,8,8,8"
                    HeightRequest="64">
                <Label Text="{Binding PackageText}"
                       FontSize="14"
                       FontAttributes="Bold"
                       TextColor="{Binding PackageButtonTextColor}"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding SelectPackageCommand}"/>
                </Border.GestureRecognizers>
            </Border>

        </Grid>

        <!-- Services Grid -->
        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Services}"
                        SelectionMode="None">

            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical"
                                 Span="3"
                                 HorizontalItemSpacing="24"
                                 VerticalItemSpacing="24"/>
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="vm:ServiceViewModel">

                    <Border Stroke="{Binding ServiceBorderColor}"
                            StrokeThickness="2"
                            StrokeShape="RoundRectangle 16,16,16,16"
                            BackgroundColor="{Binding ServiceBackgroundColor}"
                            HeightRequest="330"
                            Padding="20">

                        <VerticalStackLayout Spacing="16">

                            <!-- Icon -->
                            <Border BackgroundColor="{Binding IconBackgroundColor}"
                                    StrokeThickness="0"
                                    StrokeShape="RoundRectangle 100,100,100,100"
                                    WidthRequest="88"
                                    HeightRequest="88"
                                    HorizontalOptions="Center">
                                <Label Text="{Binding Icon}"
                                       FontSize="48"
                                       TextColor="{Binding IconColor}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>

                            <!-- Service Name -->
                            <Label Text="{Binding Name}"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   TextColor="{Binding TextColor}"
                                   HorizontalOptions="Center"
                                   HorizontalTextAlignment="Center"/>

                            <!-- Description (for packages) -->
                            <Label Text="{Binding Description}"
                                   FontSize="12"
                                   TextColor="{Binding DescriptionColor}"
                                   HorizontalOptions="Center"
                                   HorizontalTextAlignment="Center"
                                   IsVisible="{Binding HasDescription}"/>

                            <!-- Price -->
                            <Border BackgroundColor="{Binding PriceBackgroundColor}"
                                    StrokeThickness="0"
                                    StrokeShape="RoundRectangle 8,8,8,8"
                                    Padding="16,12">
                                <VerticalStackLayout Spacing="4">
                                    <Label Text="{Binding Price, StringFormat='{0:N0}'}"
                                           FontSize="24"
                                           FontAttributes="Bold"
                                           TextColor="White"
                                           HorizontalOptions="Center">

                                        <Label.Triggers>
                                            <DataTrigger TargetType="Label"
                                                         Binding="{Binding Price}"
                                                         Value="0">
                                                <Setter Property="Text"
                                                        Value="Free"/>
                                                <Setter Property="TextColor"
                                                        Value="#10B981"/>
                                                <Setter Property="FontAttributes"
                                                        Value="Bold"/>
                                            </DataTrigger>
                                        </Label.Triggers>
                                    </Label>

                                    <Label Text="RWF"
                                           FontSize="12"
                                           TextColor="White"
                                           HorizontalOptions="Center">
                                        <Label.Triggers>
                                            <DataTrigger TargetType="Label"
                                                         Binding="{Binding Price}"
                                                         Value="0">
                                                <Setter Property="Text"
                                                        Value="Complimentary"/>
                                                <Setter Property="TextColor"
                                                        Value="#10B981"/>
                                            </DataTrigger>
                                        </Label.Triggers>
                                    </Label>
                                </VerticalStackLayout>
                            </Border>

                            <!-- Tap to add -->
                            <Label Text="{Binding TapToAddText}"
                                   FontSize="12"
                                   TextColor="{Binding TapToAddColor}"
                                   HorizontalOptions="Center"/>

                        </VerticalStackLayout>

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding AddToCartCommand}"/>
                        </Border.GestureRecognizers>

                    </Border>

                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>
</ContentView>